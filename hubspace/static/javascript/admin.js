;(function($){$.ui=$.ui||{};$.extend($.ui,{plugin:{add:function(module,option,set){var proto=$.ui[module].prototype;for(var i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]]);}},call:function(instance,name,arguments){var set=instance.plugins[name];if(!set)return;for(var i=0;i<set.length;i++){if(instance.options[set[i][0]])set[i][1].apply(instance.element,arguments);}}},cssCache:{},css:function(name){if($.ui.cssCache[name])return $.ui.cssCache[name];var tmp=$('<div class="ui-resizable-gen">').addClass(name).css({position:'absolute',top:'-5000px',left:'-5000px',display:'block'}).appendTo('body');$.ui.cssCache[name]=!!((!/auto|default/.test(tmp.css('cursor'))||(/^[1-9]/).test(tmp.css('height'))||(/^[1-9]/).test(tmp.css('width'))||!(/none/).test(tmp.css('backgroundImage'))||!(/transparent|rgba\(0, 0, 0, 0\)/).test(tmp.css('backgroundColor'))));try{$('body').get(0).removeChild(tmp.get(0));}catch(e){}
return $.ui.cssCache[name];},disableSelection:function(e){e.unselectable="on";e.onselectstart=function(){return false;};if(e.style)e.style.MozUserSelect="none";},enableSelection:function(e){e.unselectable="off";e.onselectstart=function(){return true;};if(e.style)e.style.MozUserSelect="";},hasScroll:function(e,a){var scroll=/top/.test(a||"top")?'scrollTop':'scrollLeft',has=false;if(e[scroll]>0)return true;e[scroll]=1;has=e[scroll]>0?true:false;e[scroll]=0;return has;}});$.each(['Left','Top'],function(i,name){if(!$.fn['scroll'+name])$.fn['scroll'+name]=function(v){return v!=undefined?this.each(function(){this==window||this==document?window.scrollTo(name=='Left'?v:$(window)['scrollLeft'](),name=='Top'?v:$(window)['scrollTop']()):this['scroll'+name]=v;}):this[0]==window||this[0]==document?self[(name=='Left'?'pageXOffset':'pageYOffset')]||$.boxModel&&document.documentElement['scroll'+name]||document.body['scroll'+name]:this[0]['scroll'+name];};});var _remove=$.fn.remove;$.fn.extend({position:function(){var offset=this.offset();var offsetParent=this.offsetParent();var parentOffset=offsetParent.offset();return{top:offset.top-num(this[0],'marginTop')-parentOffset.top-num(offsetParent,'borderTopWidth'),left:offset.left-num(this[0],'marginLeft')-parentOffset.left-num(offsetParent,'borderLeftWidth')};},offsetParent:function(){var offsetParent=this[0].offsetParent;while(offsetParent&&(!/^body|html$/i.test(offsetParent.tagName)&&$.css(offsetParent,'position')=='static'))
offsetParent=offsetParent.offsetParent;return $(offsetParent);},mouseInteraction:function(o){return this.each(function(){new $.ui.mouseInteraction(this,o);});},removeMouseInteraction:function(o){return this.each(function(){if($.data(this,"ui-mouse"))
$.data(this,"ui-mouse").destroy();});},remove:function(){jQuery("*",this).add(this).trigger("remove");return _remove.apply(this,arguments);}});function num(el,prop){return parseInt($.curCSS(el.jquery?el[0]:el,prop,true))||0;};$.ui.mouseInteraction=function(element,options){var self=this;this.element=element;$.data(this.element,"ui-mouse",this);this.options=$.extend({},options);$(element).bind('mousedown.draggable',function(){return self.click.apply(self,arguments);});if($.browser.msie)$(element).attr('unselectable','on');$(element).mouseup(function(){if(self.timer)clearInterval(self.timer);});};$.extend($.ui.mouseInteraction.prototype,{destroy:function(){$(this.element).unbind('mousedown.draggable');},trigger:function(){return this.click.apply(this,arguments);},click:function(e){if(e.which!=1||$.inArray(e.target.nodeName.toLowerCase(),this.options.dragPrevention||[])!=-1||(this.options.condition&&!this.options.condition.apply(this.options.executor||this,[e,this.element])))return true;var self=this;var initialize=function(){self._MP={left:e.pageX,top:e.pageY};$(document).bind('mouseup.draggable',function(){return self.stop.apply(self,arguments);});$(document).bind('mousemove.draggable',function(){return self.drag.apply(self,arguments);});if(!self.initalized&&Math.abs(self._MP.left-e.pageX)>=self.options.distance||Math.abs(self._MP.top-e.pageY)>=self.options.distance){if(self.options.start)self.options.start.call(self.options.executor||self,e,self.element);if(self.options.drag)self.options.drag.call(self.options.executor||self,e,this.element);self.initialized=true;}};if(this.options.delay){if(this.timer)clearInterval(this.timer);this.timer=setTimeout(initialize,this.options.delay);}else{initialize();}
return false;},stop:function(e){var o=this.options;if(!this.initialized)return $(document).unbind('mouseup.draggable').unbind('mousemove.draggable');if(this.options.stop)this.options.stop.call(this.options.executor||this,e,this.element);$(document).unbind('mouseup.draggable').unbind('mousemove.draggable');this.initialized=false;return false;},drag:function(e){var o=this.options;if($.browser.msie&&!e.button)return this.stop.apply(this,[e]);if(!this.initialized&&(Math.abs(this._MP.left-e.pageX)>=o.distance||Math.abs(this._MP.top-e.pageY)>=o.distance)){if(this.options.start)this.options.start.call(this.options.executor||this,e,this.element);this.initialized=true;}else{if(!this.initialized)return false;}
if(o.drag)o.drag.call(this.options.executor||this,e,this.element);return false;}});})(jQuery);;(function($){if(window.Node&&Node.prototype&&!Node.prototype.contains){Node.prototype.contains=function(arg){return!!(this.compareDocumentPosition(arg)&16);};}
$.fn.extend({sortable:function(options){var args=Array.prototype.slice.call(arguments,1);if(options=="serialize"||options=="toArray")
return $.data(this[0],"sortable")[options](arguments[1]);return this.each(function(){if(typeof options=="string"){var sort=$.data(this,"sortable");if(sort)sort[options].apply(sort,args);}else if(!$.data(this,"sortable"))
new $.ui.sortable(this,options);});}});$.ui.sortable=function(element,options){var self=this;this.element=$(element);this.containerCache={};$.data(element,"sortable",this);this.element.addClass("ui-sortable");this.options=$.extend({},options);var o=this.options;$.extend(o,{items:this.options.items||'> *',zIndex:this.options.zIndex||1000,startCondition:function(){return!self.options.disabled;}});$(element).bind("setData.sortable",function(event,key,value){self.options[key]=value;}).bind("getData.sortable",function(event,key){return self.options[key];});this.refresh();this.floating=this.items.length?(/left|right/).test(this.items[0].item.css('float')):false;if(!(/(relative|absolute|fixed)/).test(this.element.css('position')))this.element.css('position','relative');this.offset=this.element.offset();this.element.mouseInteraction({executor:this,delay:o.delay,distance:o.distance||0,dragPrevention:o.prevention?o.prevention.toLowerCase().split(','):['input','textarea','button','select','option'],start:this.start,stop:this.stop,drag:this.drag,condition:function(e){if(this.options.disabled||this.options.type=='static')return false;var currentItem=null,nodes=$(e.target).parents().each(function(){if($.data(this,'sortable-item')){currentItem=$(this);return false;}});if($.data(e.target,'sortable-item'))currentItem=$(e.target);if(!currentItem)return false;if(this.options.handle){var validHandle=false;$(this.options.handle,currentItem).each(function(){if(this==e.target)validHandle=true;});if(!validHandle)return false;}
this.currentItem=currentItem;return true;}});if(o.cursorAt&&o.cursorAt.constructor==Array)
o.cursorAt={left:o.cursorAt[0],top:o.cursorAt[1]};};$.extend($.ui.sortable.prototype,{plugins:{},ui:function(inst){return{helper:(inst||this)["helper"],placeholder:(inst||this)["placeholder"]||$([]),position:(inst||this)["position"].current,absolutePosition:(inst||this)["position"].absolute,instance:this,options:this.options,element:this.element,item:(inst||this)["currentItem"],sender:inst?inst.element:null};},propagate:function(n,e,inst){$.ui.plugin.call(this,n,[e,this.ui(inst)]);this.element.triggerHandler(n=="sort"?n:"sort"+n,[e,this.ui(inst)],this.options[n]);},serialize:function(o){var items=$(this.options.items,this.element).not('.ui-sortable-helper');var str=[];o=o||{};items.each(function(){var res=($(this).attr(o.attribute||'id')||'').match(o.expression||(/(.+)[-=_](.+)/));if(res)str.push((o.key||res[1])+'[]='+(o.key?res[1]:res[2]));});return str.join('&');},toArray:function(attr){var items=$(this.options.items,this.element).not('.ui-sortable-helper');var ret=[];items.each(function(){ret.push($(this).attr(attr||'id'));});return ret;},enable:function(){this.element.removeClass("ui-sortable-disabled");this.options.disabled=false;},disable:function(){this.element.addClass("ui-sortable-disabled");this.options.disabled=true;},intersectsWith:function(item){var x1=this.position.absolute.left,x2=x1+this.helperProportions.width,y1=this.position.absolute.top,y2=y1+this.helperProportions.height;var l=item.left,r=l+item.width,t=item.top,b=t+item.height;return(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b);},intersectsWithEdge:function(item){var x1=this.position.absolute.left,x2=x1+this.helperProportions.width,y1=this.position.absolute.top,y2=y1+this.helperProportions.height;var l=item.left,r=l+item.width,t=item.top,b=t+item.height;if(!(l<x1+(this.helperProportions.width/2)&&x2-(this.helperProportions.width/2)<r&&t<y1+(this.helperProportions.height/2)&&y2-(this.helperProportions.height/2)<b))return false;if(this.floating){if(x2>l&&x1<l)return 2;if(x1<r&&x2>r)return 1;}else{if(y2>t&&y1<t)return 1;if(y1<b&&y2>b)return 2;}
return false;},inEmptyZone:function(container){if(!$(container.options.items,container.element).length){return container.options.dropOnEmpty?true:false;};var last=$(container.options.items,container.element).not('.ui-sortable-helper');last=$(last[last.length-1]);var top=last.offset()[this.floating?'left':'top']+last[0][this.floating?'offsetWidth':'offsetHeight'];return(this.position.absolute[this.floating?'left':'top']>top);},refresh:function(){this.refreshItems();this.refreshPositions();},refreshItems:function(){this.items=[];this.containers=[this];var items=this.items;var queries=[$(this.options.items,this.element)];if(this.options.connectWith){for(var i=this.options.connectWith.length-1;i>=0;i--){var cur=$(this.options.connectWith[i]);for(var j=cur.length-1;j>=0;j--){var inst=$.data(cur[j],'sortable');if(inst&&!inst.options.disabled){queries.push($(inst.options.items,inst.element));this.containers.push(inst);}};};}
for(var i=queries.length-1;i>=0;i--){queries[i].each(function(){$.data(this,'sortable-item',true);items.push({item:$(this),width:0,height:0,left:0,top:0});});};},refreshPositions:function(fast){for(var i=this.items.length-1;i>=0;i--){if(!fast)this.items[i].width=this.items[i].item.outerWidth();if(!fast)this.items[i].height=this.items[i].item.outerHeight();var p=this.items[i].item.offset();this.items[i].left=p.left;this.items[i].top=p.top;};for(var i=this.containers.length-1;i>=0;i--){var p=this.containers[i].element.offset();this.containers[i].containerCache.left=p.left;this.containers[i].containerCache.top=p.top;this.containers[i].containerCache.width=this.containers[i].element.outerWidth();this.containers[i].containerCache.height=this.containers[i].element.outerHeight();};},destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable").removeMouseInteraction();for(var i=this.items.length-1;i>=0;i--)
this.items[i].item.removeData("sortable-item");},createPlaceholder:function(that){(that||this).placeholderElement=this.options.placeholderElement?$(this.options.placeholderElement,(that||this).currentItem):(that||this).currentItem;(that||this).placeholder=$('<div></div>').addClass(this.options.placeholder).appendTo('body').css({position:'absolute'}).css((that||this).placeholderElement.offset()).css({width:(that||this).placeholderElement.outerWidth(),height:(that||this).placeholderElement.outerHeight()});},contactContainers:function(e){for(var i=this.containers.length-1;i>=0;i--){if(this.intersectsWith(this.containers[i].containerCache)){if(!this.containers[i].containerCache.over){if(this.currentContainer!=this.containers[i]){var dist=10000;var itemWithLeastDistance=null;var base=this.position.absolute[this.containers[i].floating?'left':'top'];for(var j=this.items.length-1;j>=0;j--){if(!this.containers[i].element[0].contains(this.items[j].item[0]))continue;var cur=this.items[j][this.containers[i].floating?'left':'top'];if(Math.abs(cur-base)<dist){dist=Math.abs(cur-base);itemWithLeastDistance=this.items[j];}}
if(this.placeholder)this.placeholder.remove();if(this.containers[i].options.placeholder){this.containers[i].createPlaceholder(this);}else{this.placeholder=null;this.placeholderElement=null;}
itemWithLeastDistance?this.rearrange(e,itemWithLeastDistance):this.rearrange(e,null,this.containers[i].element);this.propagate("change",e);this.containers[i].propagate("change",e,this);this.currentContainer=this.containers[i];}
this.containers[i].propagate("over",e,this);this.containers[i].containerCache.over=1;}}else{if(this.containers[i].containerCache.over){this.containers[i].propagate("out",e,this);this.containers[i].containerCache.over=0;}}};},start:function(e,el){var o=this.options;this.refresh();this.helper=typeof o.helper=='function'?$(o.helper.apply(this.element[0],[e,this.currentItem])):this.currentItem.clone();if(!this.helper.parents('body').length)this.helper.appendTo(o.appendTo||this.currentItem[0].parentNode);this.helper.css({position:'absolute',clear:'both'}).addClass('ui-sortable-helper');$.extend(this,{offsetParent:this.helper.offsetParent(),offsets:{absolute:this.currentItem.offset()},mouse:{start:{top:e.pageY,left:e.pageX}},margins:{top:parseInt(this.currentItem.css("marginTop"))||0,left:parseInt(this.currentItem.css("marginLeft"))||0}});this.offsets.parent=this.offsetParent.offset();this.clickOffset={left:e.pageX-this.offsets.absolute.left,top:e.pageY-this.offsets.absolute.top};this.originalPosition={left:this.offsets.absolute.left-this.offsets.parent.left-this.margins.left,top:this.offsets.absolute.top-this.offsets.parent.top-this.margins.top}
this.offset={left:e.pageX-this.originalPosition.left,top:e.pageY-this.originalPosition.top};$.extend(this,{position:{current:{top:e.pageY-this.offset.top,left:e.pageX-this.offset.left},absolute:{left:e.pageX-this.clickOffset.left,top:e.pageY-this.clickOffset.top},dom:this.currentItem.prev()[0]}});if(o.placeholder)this.createPlaceholder();this.propagate("start",e);this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()};if(o.cursorAt){if(o.cursorAt.top!=undefined||o.cursorAt.bottom!=undefined){this.offset.top-=this.clickOffset.top-(o.cursorAt.top!=undefined?o.cursorAt.top:(this.helperProportions.height-o.cursorAt.bottom));this.clickOffset.top=(o.cursorAt.top!=undefined?o.cursorAt.top:(this.helperProportions.height-o.cursorAt.bottom));}
if(o.cursorAt.left!=undefined||o.cursorAt.right!=undefined){this.offset.left-=this.clickOffset.left-(o.cursorAt.left!=undefined?o.cursorAt.left:(this.helperProportions.width-o.cursorAt.right));this.clickOffset.left=(o.cursorAt.left!=undefined?o.cursorAt.left:(this.helperProportions.width-o.cursorAt.right));}}
if(this.options.placeholder!='clone')$(this.currentItem).css('visibility','hidden');for(var i=this.containers.length-1;i>=0;i--){this.containers[i].propagate("activate",e,this);}
if($.ui.ddmanager)$.ui.ddmanager.current=this;if($.ui.ddmanager&&!o.dropBehaviour)$.ui.ddmanager.prepareOffsets(this,e);this.dragging=true;return false;},stop:function(e){this.propagate("stop",e);if(this.position.dom!=this.currentItem.prev()[0])this.propagate("update",e);if(!this.element[0].contains(this.currentItem[0])){this.propagate("remove",e);for(var i=this.containers.length-1;i>=0;i--){if(this.containers[i].element[0].contains(this.currentItem[0])){this.containers[i].propagate("update",e,this);this.containers[i].propagate("receive",e,this);}};};for(var i=this.containers.length-1;i>=0;i--){this.containers[i].propagate("deactivate",e,this);if(this.containers[i].containerCache.over){this.containers[i].propagate("out",e,this);this.containers[i].containerCache.over=0;}}
if($.ui.ddmanager&&!this.options.dropBehaviour)$.ui.ddmanager.drop(this,e);this.dragging=false;if(this.cancelHelperRemoval)return false;$(this.currentItem).css('visibility','');if(this.placeholder)this.placeholder.remove();this.helper.remove();return false;},drag:function(e){this.position.current={top:e.pageY-this.offset.top,left:e.pageX-this.offset.left};this.position.absolute={left:e.pageX-this.clickOffset.left,top:e.pageY-this.clickOffset.top};for(var i=this.items.length-1;i>=0;i--){var intersection=this.intersectsWithEdge(this.items[i]);if(!intersection)continue;if(this.items[i].item[0]!=this.currentItem[0]&&this.currentItem[intersection==1?"next":"prev"]()[0]!=this.items[i].item[0]&&!this.currentItem[0].contains(this.items[i].item[0])&&(this.options.type=='semi-dynamic'?!this.element[0].contains(this.items[i].item[0]):true)){this.direction=intersection==1?"down":"up";this.rearrange(e,this.items[i]);this.propagate("change",e);break;}}
this.contactContainers(e);if($.ui.ddmanager)$.ui.ddmanager.drag(this,e);this.propagate("sort",e);this.helper.css({left:this.position.current.left+'px',top:this.position.current.top+'px'});return false;},rearrange:function(e,i,a){a?a.append(this.currentItem):i.item[this.direction=='down'?'before':'after'](this.currentItem);this.refreshPositions(true);if(this.placeholderElement)this.placeholder.css(this.placeholderElement.offset());}});$.ui.plugin.add("sortable","cursor",{start:function(e,ui){var t=$('body');if(t.css("cursor"))ui.options._cursor=t.css("cursor");t.css("cursor",ui.options.cursor);},stop:function(e,ui){if(ui.options._cursor)$('body').css("cursor",ui.options._cursor);}});$.ui.plugin.add("sortable","zIndex",{start:function(e,ui){var t=ui.helper;if(t.css("zIndex"))ui.options._zIndex=t.css("zIndex");t.css('zIndex',ui.options.zIndex);},stop:function(e,ui){if(ui.options._zIndex)$(ui.helper).css('zIndex',ui.options._zIndex);}});$.ui.plugin.add("sortable","opacity",{start:function(e,ui){var t=ui.helper;if(t.css("opacity"))ui.options._opacity=t.css("opacity");t.css('opacity',ui.options.opacity);},stop:function(e,ui){if(ui.options._opacity)$(ui.helper).css('opacity',ui.options._opacity);}});$.ui.plugin.add("sortable","revert",{stop:function(e,ui){var self=ui.instance;self.cancelHelperRemoval=true;var cur=self.currentItem.offset();var op=self.helper.offsetParent().offset();if(ui.instance.options.zIndex)ui.helper.css('zIndex',ui.instance.options.zIndex);if(ui.instance.placeholder)ui.instance.placeholder.animate({opacity:'hide'},parseInt(ui.options.revert,10)||500);ui.helper.animate({left:cur.left-op.left-self.margins.left,top:cur.top-op.top-self.margins.top},parseInt(ui.options.revert,10)||500,function(){self.currentItem.css('visibility','visible');window.setTimeout(function(){if(self.placeholder)self.placeholder.remove();self.helper.remove();if(ui.options._zIndex)ui.helper.css('zIndex',ui.options._zIndex);},50);});}});$.ui.plugin.add("sortable","containment",{start:function(e,ui){var o=ui.options;if((o.containment.left!=undefined||o.containment.constructor==Array)&&!o._containment)return;if(!o._containment)o._containment=o.containment;if(o._containment=='parent')o._containment=this[0].parentNode;if(o._containment=='sortable')o._containment=this[0];if(o._containment=='document'){o.containment=[0,0,$(document).width(),($(document).height()||document.body.parentNode.scrollHeight)];}else{var ce=$(o._containment);var co=ce.offset();o.containment=[co.left,co.top,co.left+(ce.outerWidth()||ce[0].scrollWidth),co.top+(ce.outerHeight()||ce[0].scrollHeight)];}},sort:function(e,ui){var o=ui.options;var h=ui.helper;var c=o.containment;var self=ui.instance;var borderLeft=(parseInt(self.offsetParent.css("borderLeftWidth"),10)||0);var borderRight=(parseInt(self.offsetParent.css("borderRightWidth"),10)||0);var borderTop=(parseInt(self.offsetParent.css("borderTopWidth"),10)||0);var borderBottom=(parseInt(self.offsetParent.css("borderBottomWidth"),10)||0);if(c.constructor==Array){if((self.position.absolute.left<c[0]))self.position.current.left=c[0]-self.offsets.parent.left-self.margins.left;if((self.position.absolute.top<c[1]))self.position.current.top=c[1]-self.offsets.parent.top-self.margins.top;if(self.position.absolute.left-c[2]+self.helperProportions.width>=0)self.position.current.left=c[2]-self.offsets.parent.left-self.helperProportions.width-self.margins.left-borderLeft-borderRight;if(self.position.absolute.top-c[3]+self.helperProportions.height>=0)self.position.current.top=c[3]-self.offsets.parent.top-self.helperProportions.height-self.margins.top-borderTop-borderBottom;}else{if((ui.position.left<c.left))self.position.current.left=c.left;if((ui.position.top<c.top))self.position.current.top=c.top;if(ui.position.left-self.offsetParent.innerWidth()+self.helperProportions.width+c.right+borderLeft+borderRight>=0)self.position.current.left=self.offsetParent.innerWidth()-self.helperProportions.width-c.right-borderLeft-borderRight;if(ui.position.top-self.offsetParent.innerHeight()+self.helperProportions.height+c.bottom+borderTop+borderBottom>=0)self.position.current.top=self.offsetParent.innerHeight()-self.helperProportions.height-c.bottom-borderTop-borderBottom;}}});$.ui.plugin.add("sortable","axis",{sort:function(e,ui){var o=ui.options;if(o.constraint)o.axis=o.constraint;o.axis=='x'?ui.instance.position.top=ui.instance.originalPosition.top:ui.instance.position.left=ui.instance.originalPosition.left;}});$.ui.plugin.add("sortable","scroll",{start:function(e,ui){var o=ui.options;o.scrollSensitivity=o.scrollSensitivity||20;o.scrollSpeed=o.scrollSpeed||20;ui.instance.overflowY=function(el){do{if((/auto|scroll/).test(el.css('overflow'))||(/auto|scroll/).test(el.css('overflow-y')))return el;el=el.parent();}while(el[0].parentNode);return $(document);}(this);ui.instance.overflowX=function(el){do{if((/auto|scroll/).test(el.css('overflow'))||(/auto|scroll/).test(el.css('overflow-x')))return el;el=el.parent();}while(el[0].parentNode);return $(document);}(this);if(ui.instance.overflowY[0]!=document&&ui.instance.overflowY[0].tagName!='HTML')ui.instance.overflowYstart=ui.instance.overflowY[0].scrollTop;if(ui.instance.overflowX[0]!=document&&ui.instance.overflowX[0].tagName!='HTML')ui.instance.overflowXstart=ui.instance.overflowX[0].scrollLeft;},sort:function(e,ui){var o=ui.options;var i=ui.instance;if(i.overflowY[0]!=document&&i.overflowY[0].tagName!='HTML'){if(i.overflowY[0].offsetHeight-(ui.position.top-i.overflowY[0].scrollTop+i.clickOffset.top)<o.scrollSensitivity)
i.overflowY[0].scrollTop=i.overflowY[0].scrollTop+o.scrollSpeed;if((ui.position.top-i.overflowY[0].scrollTop+i.clickOffset.top)<o.scrollSensitivity)
i.overflowY[0].scrollTop=i.overflowY[0].scrollTop-o.scrollSpeed;}else{if(e.pageY-$(document).scrollTop()<o.scrollSensitivity)
$(document).scrollTop($(document).scrollTop()-o.scrollSpeed);if($(window).height()-(e.pageY-$(document).scrollTop())<o.scrollSensitivity)
$(document).scrollTop($(document).scrollTop()+o.scrollSpeed);}
if(i.overflowX[0]!=document&&i.overflowX[0].tagName!='HTML'){if(i.overflowX[0].offsetWidth-(ui.position.left-i.overflowX[0].scrollLeft+i.clickOffset.left)<o.scrollSensitivity)
i.overflowX[0].scrollLeft=i.overflowX[0].scrollLeft+o.scrollSpeed;if((ui.position.top-i.overflowX[0].scrollLeft+i.clickOffset.left)<o.scrollSensitivity)
i.overflowX[0].scrollLeft=i.overflowX[0].scrollLeft-o.scrollSpeed;}else{if(e.pageX-$(document).scrollLeft()<o.scrollSensitivity)
$(document).scrollLeft($(document).scrollLeft()-o.scrollSpeed);if($(window).width()-(e.pageX-$(document).scrollLeft())<o.scrollSensitivity)
$(document).scrollLeft($(document).scrollLeft()+o.scrollSpeed);}
i.offset={left:i.mouse.start.left-i.originalPosition.left+(i.overflowXstart!==undefined?i.overflowXstart-i.overflowX[0].scrollLeft:0),top:i.mouse.start.top-i.originalPosition.top+(i.overflowYstart!==undefined?i.overflowYstart-i.overflowX[0].scrollTop:0)};}});})(jQuery);jQuery.tableDnD={currentTable:null,dragObject:null,mouseOffset:null,oldY:0,build:function(options){options=options||{};this.each(function(){this.tableDnDConfig={onDragStyle:options.onDragStyle,onDropStyle:options.onDropStyle,onDragClass:options.onDragClass?options.onDragClass:"tDnD_whileDrag",onDrop:options.onDrop,onDragStart:options.onDragStart,scrollAmount:options.scrollAmount?options.scrollAmount:5};jQuery.tableDnD.makeDraggable(this);});jQuery(document).bind('mousemove',jQuery.tableDnD.mousemove).bind('mouseup',jQuery.tableDnD.mouseup);return this;},makeDraggable:function(table){var rows=table.tBodies[0].rows;var config=table.tableDnDConfig;for(var i=0;i<rows.length;i++){var nodrag=rows[i].getAttribute("NoDrag");if(nodrag==null||nodrag=="undefined"){jQuery(rows[i]).mousedown(function(ev){if(ev.target.tagName=="TD"){jQuery.tableDnD.dragObject=this;jQuery.tableDnD.currentTable=table;jQuery.tableDnD.mouseOffset=jQuery.tableDnD.getMouseOffset(this,ev);if(config.onDragStart){config.onDragStart(table,this);}
return false;}}).css("cursor","move");}}},mouseCoords:function(ev){if(ev.pageX||ev.pageY){return{x:ev.pageX,y:ev.pageY};}
return{x:ev.clientX+document.body.scrollLeft-document.body.clientLeft,y:ev.clientY+document.body.scrollTop-document.body.clientTop};},getMouseOffset:function(target,ev){ev=ev||window.event;var docPos=this.getPosition(target);var mousePos=this.mouseCoords(ev);return{x:mousePos.x-docPos.x,y:mousePos.y-docPos.y};},getPosition:function(e){var left=0;var top=0;if(e.offsetHeight==0){e=e.firstChild;}
while(e.offsetParent){left+=e.offsetLeft;top+=e.offsetTop;e=e.offsetParent;}
left+=e.offsetLeft;top+=e.offsetTop;return{x:left,y:top};},mousemove:function(ev){if(jQuery.tableDnD.dragObject==null){return;}
var dragObj=jQuery(jQuery.tableDnD.dragObject);var config=jQuery.tableDnD.currentTable.tableDnDConfig;var mousePos=jQuery.tableDnD.mouseCoords(ev);var y=mousePos.y-jQuery.tableDnD.mouseOffset.y;var yOffset=window.pageYOffset;if(document.all){yOffset=document.body.scrollTop;}
if(mousePos.y-yOffset<config.scrollAmount){window.scrollBy(0,-config.scrollAmount);}else{var windowHeight=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:document.body.clientHeight;if(windowHeight-(mousePos.y-yOffset)<5){window.scrollBy(0,5);}}
if(y!=jQuery.tableDnD.oldY){var movingDown=y>jQuery.tableDnD.oldY;jQuery.tableDnD.oldY=y;if(config.onDragClass){dragObj.addClass(config.onDragClass);}else{dragObj.css(config.onDragStyle);}
var currentRow=jQuery.tableDnD.findDropTargetRow(y);if(currentRow){if(movingDown&&jQuery.tableDnD.dragObject!=currentRow){jQuery.tableDnD.dragObject.parentNode.insertBefore(jQuery.tableDnD.dragObject,currentRow.nextSibling);}else if(!movingDown&&jQuery.tableDnD.dragObject!=currentRow){jQuery.tableDnD.dragObject.parentNode.insertBefore(jQuery.tableDnD.dragObject,currentRow);}}}
return false;},findDropTargetRow:function(y){var rows=jQuery.tableDnD.currentTable.tBodies[0].rows;for(var i=0;i<rows.length;i++){var row=rows[i];var nodrop=row.getAttribute("NoDrop");if(nodrop==null||nodrop=="undefined"){var rowY=this.getPosition(row).y;var rowHeight=parseInt(row.offsetHeight)/2;if(row.offsetHeight==0){rowY=this.getPosition(row.firstChild).y;rowHeight=parseInt(row.firstChild.offsetHeight)/2;}
if((y>rowY-rowHeight)&&(y<(rowY+rowHeight))){return row;}}}
return null;},mouseup:function(e){if(jQuery.tableDnD.currentTable&&jQuery.tableDnD.dragObject){var droppedRow=jQuery.tableDnD.dragObject;var config=jQuery.tableDnD.currentTable.tableDnDConfig;if(config.onDragClass){jQuery(droppedRow).removeClass(config.onDragClass);}else{jQuery(droppedRow).css(config.onDropStyle);}
jQuery.tableDnD.dragObject=null;if(config.onDrop){config.onDrop(jQuery.tableDnD.currentTable,droppedRow);}
jQuery.tableDnD.currentTable=null;}}}
jQuery.fn.extend({tableDnD:jQuery.tableDnD.build});function create_sortables(loc){var sortable_sublist=function(id){var group=jq(id);var other_groups=jq.map(groups,function(n){if(n===id){return}else{return n}});var obj={element:group[0],create_sortable_group:function(){var that=this;group.sortable({containment:'#resource_groups_area',items:'> li.resource_item',connectWith:other_groups,update:function(){that.update()},handle:'> .handle'});},update:function(){if(lock){return}
lock=true;serialize_all();}}
obj.create_sortable_group();return obj}
var order_saved=function(){overlib("order saved");lock=false;jq('body').oneTime("1s",function(){nd();});}
var groups=jq('.resource_group');groups=jq.map(groups,function(ele){return'#'+ele.id});var lists={};var lock=false;var sort=function(){jq.each(groups,function(n,id){lists[id]=sortable_sublist(id);});jq('#resource_groups').tableDnD({onDragClass:'dragClass',onDrop:serialize_all});};var serialize_all=function(){var params={};var params_string=[];jq.each(lists,function(id,list){params[id]=jq(list.element).sortable('toArray');var hidden_input=jq(id+' input.group_name');var name='res_group.'+hidden_input.val();jq.each(params[id],function(list_id,val){var list_id=String(list_id+1);params_string[params_string.length]=name+'-'+list_id+'='+val.split('-')[1];});});var groups_order=jq('.resource_group');groups_order=jq.map(groups_order,function(element,i){return'group-'+String(i+1)+'='+element.id.split('-')[1]});params_string=params_string.concat(groups_order);params_string=params_string.concat('loc='+loc);params_string=params_string.join('&');jq.post('/save_res_groups',params_string,function(){order_saved()});return params_string}
sort();return lists}compiled = true;